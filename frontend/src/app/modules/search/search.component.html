<mat-card>
  <mat-card-header>
    <mat-card-title>Search Documents</mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <div class="search-container">
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>Search for documents...</mat-label>
        <input 
          matInput 
          [formControl]="searchControl" 
          placeholder="Enter search terms">
        <mat-icon matPrefix>search</mat-icon>
        <button 
          mat-icon-button 
          matSuffix 
          *ngIf="searchControl.value"
          (click)="searchControl.setValue('')">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <!-- Suggestions -->
      <div class="suggestions" *ngIf="suggestions.length > 0">
        <div 
          class="suggestion-item" 
          *ngFor="let suggestion of suggestions"
          (click)="selectSuggestion(suggestion)">
          <mat-icon>history</mat-icon>
          {{ suggestion }}
        </div>
      </div>

      <!-- Search Controls -->
      <div class="search-controls" *ngIf="searchResults.length > 0">
        <div class="search-info">
          <span>{{ totalResults }} results found in {{ searchTime }}ms</span>
        </div>
        <mat-form-field appearance="outline" class="sort-field">
          <mat-label>Sort by</mat-label>
          <mat-select [(value)]="sortBy" (selectionChange)="onSortChange()">
            <mat-option value="relevance">Relevance</mat-option>
            <mat-option value="date">Date</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>

    <!-- Loading -->
    <div *ngIf="isSearching" class="loading-spinner">
      <mat-spinner></mat-spinner>
    </div>

    <!-- Search Results -->
    <div class="search-results" *ngIf="!isSearching && searchResults.length > 0">
      <div class="result-item" *ngFor="let result of searchResults">
        <div class="result-header">
          <mat-icon [class]="'file-icon ' + getFileIcon(result.file_type)">
            {{ getFileIcon(result.file_type) }}
          </mat-icon>
          <div class="result-info">
            <h3>{{ result.original_filename }}</h3>
            <div class="result-meta">
              <span>{{ formatFileSize(result.file_size) }}</span>
              <span>•</span>
              <span>{{ result.created_at | date:'short' }}</span>
              <span *ngIf="sortBy === 'relevance'">•</span>
              <span *ngIf="sortBy === 'relevance'" class="relevance">
                Relevance: {{ (result.relevance * 100).toFixed(0) }}%
              </span>
            </div>
          </div>
          <button 
            mat-icon-button 
            (click)="downloadDocument(result)"
            matTooltip="Download">
            <mat-icon>download</mat-icon>
          </button>
        </div>
        <div class="result-preview" [innerHTML]="result.preview"></div>
      </div>

      <!-- Pagination -->
      <mat-paginator 
        [length]="totalResults"
        [pageSize]="pageSize"
        [pageSizeOptions]="[5, 10, 25, 50]"
        [pageIndex]="currentPage - 1"
        (page)="onPageChange($event)"
        showFirstLastButtons>
      </mat-paginator>
    </div>

    <!-- No Results -->
    <div 
      class="no-results" 
      *ngIf="!isSearching && searchControl.value && searchResults.length === 0">
      <mat-icon>search_off</mat-icon>
      <p>No documents found matching "{{ searchControl.value }}"</p>
    </div>

    <!-- Initial State -->
    <div 
      class="search-prompt" 
      *ngIf="!isSearching && !searchControl.value">
      <mat-icon>search</mat-icon>
      <p>Enter search terms to find documents</p>
    </div>
  </mat-card-content>
</mat-card>
